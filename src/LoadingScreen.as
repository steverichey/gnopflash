package {	import flash.display.DisplayObject;	import flash.display.MovieClip;	import flash.display.StageAlign;	import flash.display.StageScaleMode;	import flash.events.Event;	import flash.events.IOErrorEvent;	import flash.events.ProgressEvent;	import flash.utils.getDefinitionByName;	import flash.display.Sprite;		/**	 * ...	 * @author Steve	 */	public class LoadingScreen extends MovieClip 	{		private var barWidth:Number;		private var loadBox:Sprite;		private var whiteBox:Sprite;		private var loadBar:Sprite;				public function LoadingScreen() 		{			if (stage) {				stage.scaleMode = StageScaleMode.NO_SCALE;				stage.align = StageAlign.TOP_LEFT;				stage.stageFocusRect = false;			}						addEventListener(Event.ENTER_FRAME, checkFrame);			loaderInfo.addEventListener(ProgressEvent.PROGRESS, progress);			loaderInfo.addEventListener(IOErrorEvent.IO_ERROR, ioError);						//stage.scaleMode = StageScaleMode.NO_SCALE;			//stage.align = StageAlign.TOP_LEFT;			stage.stageFocusRect = false;						barWidth = 200;			var barHeight:uint = 8;			var left:uint = ( 640 / 2 ) - ( barWidth / 2 );			var top:uint = ( 480 / 2 ) - ( barHeight / 2 );						loadBox = new Sprite();			loadBox.graphics.beginFill( 0xFFFFFF );			loadBox.graphics.drawRect( 0, 0, ( barWidth + 2 ), ( barHeight + 2 ) );			loadBox.graphics.endFill();			loadBox.x = left - 1;			loadBox.y = top - 1;			addChild( loadBox );						whiteBox = new Sprite();			whiteBox.graphics.beginFill( 0x000000 );			whiteBox.graphics.drawRect( 0, 0, barWidth, barHeight );			whiteBox.graphics.endFill();			whiteBox.x = left;			whiteBox.y = top;			addChild( whiteBox );						loadBar = new Sprite();			loadBar.graphics.beginFill( 0xFFFFFF );			loadBar.graphics.drawRect( 0, 0, barWidth, barHeight );			loadBar.graphics.endFill();			loadBar.x = left;			loadBar.y = top;			//loadBar.width = 1;			addChild( loadBar );		}				private function ioError(e:IOErrorEvent):void 		{			trace(e.text);		}				private function progress(e:ProgressEvent):void 		{			loadBar.width = e.bytesLoaded / e.bytesTotal * barWidth;		}				private function checkFrame(e:Event):void 		{			if (currentFrame == totalFrames) 			{				stop();				loadingFinished();			}		}				private function loadingFinished():void 		{			removeEventListener(Event.ENTER_FRAME, checkFrame);			loaderInfo.removeEventListener(ProgressEvent.PROGRESS, progress);			loaderInfo.removeEventListener(IOErrorEvent.IO_ERROR, ioError);						removeChild( loadBox );			removeChild( whiteBox );			removeChild( loadBar );			loadBox = null;			whiteBox = null;			loadBar = null;						startup();		}				private function startup():void 		{			var mainClass:Class = getDefinitionByName("Main") as Class;			addChild(new mainClass() as DisplayObject);		}	}}